<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cricket</title>

    <style>
      body {
        text-align: center;
      }
    </style>
  </head>

  <body>
    <h2>Bat Ball Stump Game</h2>

    <button class="bat"
      onclick="
  //user choice
  const userChoice='Bat';
  const userChoiceMsg=`You have choosen ${userChoice}`;

  //computer choice mechanism
  let computerChoice=generateComputerChoice();
  let computerChoiceMsg=`Computer choose ${computerChoice}`;
  
  //result :
  const resultMsg=getResult(userChoice,computerChoice);

  //popup :
  showResult(userChoiceMsg,computerChoiceMsg,resultMsg);
  "
    >Bat</button>


    <button class="ball"
      onclick="
  //user choice
  userChoice='Ball';
  userChoiceMsg=`You have choosen ${userChoice}`;

  //computer choice mechanism
  computerChoice=generateComputerChoice();
  computerChoiceMsg=`Computer choose ${computerChoice}`;

  //result :
  resultMsg=getResult(userChoice,computerChoice);

  //popup :
  showResult(userChoiceMsg,computerChoiceMsg,resultMsg);
  
  "
    >Ball</button>


    <button class="stump"
      onclick="
  //user choice
  userChoice='Stump';
  userChoiceMsg=`You have choosen ${userChoice}`;

  //computer choice mechanism
  computerChoice=generateComputerChoice();
  computerChoiceMsg=`Computer choose ${computerChoice}`;

  //result :
  resultMsg=getResult(userChoice,computerChoice);

  //popup :
  showResult(userChoiceMsg,computerChoiceMsg,resultMsg);
  "
    >Stump</button>

    <button onclick="
    localStorage.clear();
    resetScore();
    ">Reset</button>

    <script>
      //objects :Encapsulate all the things in object
      let userScoreStr=localStorage.getItem('userScore');
      // let userScore;
      // if(userScoreStr != undefined){
      //   userScore=JSON.parse(userScoreStr);
      // }
      // else{
      //   userScore={
      //     win:0,
      //     lost:0,
      //     tie:0,
      //   };
      // }

      //shprt trick to define by Guard operator :
      let userScore=JSON.parse(userScoreStr) || { //if JSON.parse(userScore) undefined then by defualt value assign
           win:0,
           lost:0,
           tie:0,
         };

      userScore.displayScore = function(){
          return `Won:${this.win} , Lost:${this.lost} , Tie:${this.tie}`;
        }


      //methods :

      function generateComputerChoice() {
        //computer choice mechanism
        let computerChoice; //here it is local or functional vairbale for that reason we will create the new variable on the functional call side.
        let randomNum = Math.ceil(Math.random() * 3); //generate randome number from 1 to 3

        if (randomNum === 1) {
          computerChoice = "Bat";
        } else if (randomNum === 2) {
          computerChoice = "Ball";
        } else {
          computerChoice = "Stump";
        }
        return computerChoice;
      }

      //for decision or result :

      function getResult(userMove, ComputerMove) {
        //decision or result :
        let resultMsg;
        
        if(userMove===ComputerMove){
          resultMsg='It is a tie';
          userScore.tie++;
        }
        else if(userMove==='Bat'){
          if(ComputerMove==='Ball'){
            resultMsg='User won'
            userScore.win++;
            
          }else if(ComputerMove==='Wicket'){
            resultMsg='Computer won';
            userScore.lost++;
          }else{
            resultMsg='It is a tie'; //not required becuase we check first if condition but for backup we will use this.
            userScore.tie++;
          }
        }
        else if(userMove==='Ball'){
          if(ComputerMove==='Bat'){
            resultMsg='Computer won';
            userScore.lost++;
          }else if(ComputerMove==='Wicket'){
            resultMsg='User won';
            userScore.win++;
          }else{
            resultMsg='It is a tie';
            userScore.tie++;
          }
        }
        else{
          if(ComputerMove==='Ball'){
            resultMsg='Computer won';
            userScore.lost++;
          }else if(ComputerMove==='Bat'){
            resultMsg='User won';
            userScore.win++;
          }else{
            resultMsg='It is a tie';
            userScore.tie++;
          }
        }

        //here we update the score so we store in local storage :
        localStorage.setItem('userScore',JSON.stringify(userScore));

        return resultMsg;
        
      }

      //alert pop up :

      function showResult(userMove,ComputerMove,resultMsg){
        alert(`${userMove} , ${ComputerMove} 
         
        ${resultMsg}
        
        ${userScore.displayScore()};
        `); //if we refresh the page then it reset the score we can store in local storage in future.
      }

      //reset function :
      function resetScore(){
        userScore={
          win:0,
          lost:0,
          tie:0,
        };

        userScore.displayScore = function(){
          return `Won:${this.win} , Lost:${this.lost} , Tie:${this.tie}`;
        }
      }
    </script>
  </body>
</html>
